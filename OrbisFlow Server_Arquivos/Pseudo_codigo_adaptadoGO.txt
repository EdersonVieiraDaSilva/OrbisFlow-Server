Algoritmo OrbisFlow_Server_V2

Inicio {
    CONFIGURAR Porta = 8080
    CONFIGURAR Pasta_Base = "./Pasta_OrbisFlow"

    // Servidor entra em modo de espera (Listen)
    ESCUTAR na Porta 8080

    PARA CADA nova_conexao {
        // Go faz isso automaticamente com Goroutines (Concorrência)
        
        REQUISICAO = ler_dados_do_cliente()
        ARQUIVO_NOME = extrair_nome_do_video(REQUISICAO)
        CAMINHO_COMPLETO = Pasta_Base + ARQUIVO_NOME

        SE (checar_se_arquivo_existe(CAMINHO_COMPLETO)) {
            
            ARQUIVO = abrir_arquivo(CAMINHO_COMPLETO)
            TAMANHO = obter_tamanho(ARQUIVO)
            
            ENVIAR_CABECALHO_HTTP(Status: 200 ou 206, Tipo: "video/mp4")

            // LOOP DE STREAMING (O Coração do Projeto)
            ENQUANTO (não atingir o fim do arquivo) {
                BUFFER = ler_pedaco_do_arquivo(tamanho: 32kb)
                
                SE (erro na rede ou cliente desconectou) {
                    LOG("Conexão interrompida pelo cliente")
                    PARAR_LOOP
                }
                
                ENVIAR_PARA_CLIENTE(BUFFER)
            }
            
            FECHAR(ARQUIVO)
            LOG("Streaming finalizado com sucesso")

        } SENAO {
            ENVIAR_ERRO(404, "Vídeo não encontrado")
        }
    }
}
Fim